<link rel="import" href="../../bower_components/polymer/polymer.html">

<link rel="import" href="ivx-qtype-builder-base.html">

<polymer-element name="ivx-qtype-builder-insertions" extends="ivx-qtype-builder-base" attributes="">
  <template>
    <link rel="stylesheet" href="ivx-qtype-builder-insertions.css">

    <template if="{{ _innerHTML }}">
      <strong>Insertion Points:</strong><br>
      <br>
      <textarea id="area" value="{{ _innerHTML }}"></textarea>
    </template>
  </template>

  <script>
    (function () {
      Polymer({
        _innerHTML: '',
        _properties: [], // storing {name: '', value: ''}
        _dummyString: 'text text',
        _roundsPerEl: 3,

        prepare: function(keyValue, propValue) {
          this._properties.push(keyValue);

          var propLength = Object.keys(propValue).length;
          var currElCount = 1;
          for (var elName in propValue) {
            var el = '<' + elName + '>' + this._dummyString + '</' + elName + '>';
            for (var i = 0; i < this._roundsPerEl; i++) {
              this._innerHTML  += el + '\n';

              var lastIterRound = (i == this._roundsPerEl - 1);
              var morePropsAfter = currElCount < propLength;
              if (lastIterRound && morePropsAfter) {
                this._innerHTML  += '\n';
              }
            }
            ++currElCount;
          }
        },

        reset: function() {
          this._innerHTML = this._prettyHTML = '';
        },

        getProperties: function() {
          return this._innerHTML;
        }
      });
    })();
  </script>
</polymer-element>

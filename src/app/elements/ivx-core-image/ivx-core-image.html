<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../mixins-core.html">

<polymer-element name="ivx-core-image" constructor="IvxCoreImage" attributes="">
  <script>
    (function () {
      Polymer(Polymer.mixin({
        _width: 0,
        _height: 0,

        _videoEl: null,
        _canvas: document.createElement('canvas'),

        init: function(videoEl, width, height) {
          this._videoEl = videoEl;
          this._canvas.width = width * 2;
          this._canvas.height = height * 2;
        },

        getPictureDataURL: function(type, quality) {
          var typeCheck = (type == 'image/jpeg' || type == 'image/webp');
          var qualityCheck = (quality >= 0.0 && quality <= 1.0);

          if (!typeCheck || !qualityCheck) {
            return false;
          }

          this._drawImage();
          return this._canvas.toDataURL(type, quality);
        },

        // ===== private methods =====
        _drawImage: function() {
          this._canvas.getContext('2d').drawImage(
            this._videoEl,
            0,
            0,
            this._canvas.width,
            this._canvas.height
          );
        }
      }, mixinsCore));

    })();
  </script>
</polymer-element>
